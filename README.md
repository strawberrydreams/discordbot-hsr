# 🤖 개인용 디스코드 봇 프로젝트 (Discord Bot HSR)

이미지

이 프로젝트는 **개인적인 디스코드 서버에서 사용하기 위해 제작된 커스텀 봇**입니다. 작성자의 개인적인 필요와 서버 환경에 맞춰 개발되었으며, 범용적인 사용보다는 특정 커뮤니티의 편의 기능을 제공하는 데 초점을 맞추고 있습니다.

## 📂 프로젝트 구조 및 모듈 설명

이 프로젝트의 핵심 기능은 `module/slash/` 디렉터리에 모듈화되어 있습니다.

### `module/slash/` (핵심 기능)

이 디렉터리의 파일들은 디스코드의 **Slash Command (슬래시 명령어)** 기능을 기반으로 동작하는 최신 코드들입니다.

| 파일명 | 설명 |
| :--- | :--- |
| **`main.py`** | 봇의 진입점(Entry Point)입니다. 봇을 실행하고, 다른 모듈(Cogs)들을 로드하며, 디스코드 서버와 연결하는 역할을 합니다. |
| **`config.py`** | 프로젝트의 환경 변수(API 키, 토큰 등)와 상수(채널 ID, 게임 설정 등)를 관리하는 설정 파일입니다. |
| **`attendance_module.py`** | **출석체크 및 포인트 시스템**을 담당합니다. 매일 출석을 통해 포인트를 획득하고, 럭키박스(도박), 랭킹 확인, 프로필 조회 등의 기능을 제공합니다. SQLite 데이터베이스(`attendance_data.db`)를 사용합니다. |
| **`makeparty_module.py`** | **게임 파티 모집 시스템**입니다. '모집', '참가', '나가기' 등의 명령어를 통해 게임별 파티를 구성하고 역할을 분배할 수 있습니다. SQLite 데이터베이스(`party_data.db`)를 사용합니다. |
| **`hyacine_gpt_5_module.py`** | **OpenAI GPT-5.1 기반의 대화형 AI '히아킨'** 모듈입니다. 사용자와 자연스러운 대화를 나누며, '기본(Instant)' 모드와 '고급(Thinking)' 모드를 제공합니다. 고급 모드 사용 시 포인트를 소모합니다. |
| **`hyacine_gemini_module.py`** | **Google Gemini (Nano Banana Pro) 기반의 이미지 생성** 모듈입니다. 포인트를 소모하여 사용자가 요청한 그림을 그려줍니다. |
| **`eventnotify_module.py`** | 디스코드 서버의 **예정된 이벤트 정보**를 조회하고 보여주는 알림 모듈입니다. |
| **`forbiddenfilter_cog.py`** | **강력한 금지어 필터링 시스템**입니다. 2중 필터(기본+변칙 표기 감지)를 통해 '아1니' 같은 회피 시도까지 잡아내며, 출석 모듈과 연동하여 경고 횟수를 기록합니다. |
| **`finance_cog.py`** | **실시간 금융 시세 조회** 모듈입니다. `/주가` 명령어로 주요 지표(주식, 코인, 유가 등)를 확인합니다. |

---

### 🏚️ Legacy Code (`single/`, `module/prefix/`)

*   **`single/`**: 모듈화되기 전, 단일 파일로 기능이 구현되었던 초기 코드들입니다. 현재는 사용되지 않거나 참고용으로 보존되어 있습니다.
*   **`module/prefix/`**: Slash Command가 도입되기 전, `!`와 같은 접두사(Prefix)를 사용하여 명령어를 처리하던 구버전 모듈들입니다. 현재 프로젝트의 주력은 `module/slash/`의 슬래시 명령어입니다.

---

## 🛠️ 사용 및 커스텀 가이드

이 봇을 당신의 개인 서버에 맞게 커스텀하여 사용하려면 다음 단계가 필요합니다.

### 1. 필수 설정 (`config.py` 및 환경 변수)

`settings/` 디렉터리에 다음 `.env` 파일들을 생성하고 키를 입력해야 합니다.

*   `DISCORD_TOKEN.env`: `DISCORD_TOKEN=your_token_here`
*   `OPENAI_API_KEY.env`: `OPENAI_API_KEY=sk-...`
*   `GOOGLE_API_KEY.env`: `GOOGLE_API_KEY=AIza...`

또한 `module/slash/config.py` 파일에서 다음 ID들을 본인의 서버에 맞게 수정해야 합니다.

```python
# module/slash/config.py

RECRUIT_CHANNEL_ID = 1234567890... # 파티 모집을 진행할 채널 ID
EVENT_CHANNEL_ID = 1234567890...   # 이벤트 알림을 띄울 채널 ID
```

### 2. 주요 명령어 (Slash Commands)

봇이 실행되면 디스코드 입력창에서 `/`를 눌러 다음 명령어들을 사용할 수 있습니다.

#### 📝 출석 & 포인트
*   `/출석`: 매일 포인트를 획득합니다.
*   `/지갑`: 내 포인트 잔액을 확인합니다.
*   `/럭키박스 [금액]`: 포인트를 걸고 도박을 합니다.
*   `/랭킹`: 포인트 부자 순위를 봅니다.
*   `/프로필 [유저]`: 유저의 상세 정보를 봅니다.

#### 🎮 파티 모집
*   `/모집`: (모집 채널 전용) 게임 파티 모집창을 띄웁니다.
*   `/참가`, `/나가기`: 파티에 참여하거나 나갑니다.
*   `/파티`: 현재 모집 중인 파티 현황을 봅니다.

#### 🤖 AI (히아킨)
*   `/대화 [내용]`: 히아킨과 대화합니다.
*   `/이미지 [프롬프트]`: 그림을 그려달라고 요청합니다 (포인트 소모).
*   `/고급`, `/기본`: GPT 모델을 전환합니다.

#### 🛡️ 기타
*   `/이벤트 [번호]`: 서버 이벤트를 확인합니다.

#### 📈 금융
*   `/주가`: 주요 금융 지표(S&P500, 나스닥, 국채, 유가, 비트코인 등)의 실시간 시세를 조회합니다.

---

## ☁️ Cloudtype 배포 가이드

이 봇을 **Cloudtype**에 배포하여 24시간 실행하려면 다음 설정을 따라주세요.

### 1. 저장소 준비
1.  이 프로젝트를 본인의 **GitHub 비공개 저장소(Private Repo)**에 업로드합니다.
2.  `prohibited_words.json` 파일도 저장소에 포함하거나, 아래의 '파일 마운트' 기능을 이용해야 합니다.

### 2. Cloudtype 프로젝트 생성
1.  Cloudtype 대시보드에서 **[새 프로젝트]** -> **[애플리케이션]** -> **[GitHub]**를 선택합니다.
2.  업로드한 봇 저장소를 선택합니다.
3.  **언어/프레임워크**: `Python`을 선택합니다.
4.  **버전**: `3.11` 이상을 권장합니다.
5.  **빌드 명령어**: `pip install -r requirements.txt` (기본값)
6.  **시작 명령어**: `python module/slash/main.py`

### 3. 환경 변수 설정 (Environment Variables)
배포 설정 화면의 **[환경변수]** 탭에서 다음 변수들을 추가합니다. (비밀 값은 'Secret'으로 설정하세요)

*   `DISCORD_TOKEN`: 디스코드 봇 토큰
*   `OPENAI_API_KEY`: OpenAI API 키
*   `GOOGLE_API_KEY`: Google Gemini API 키
*   `DATA_DIR`: `/app/data` (데이터가 저장될 경로)

### 4. 영구 저장소 설정 (Persistent Volume) **(중요!)**
SQLite 데이터베이스(`attendance_data.db`, `party_data.db`)가 재배포 시에도 초기화되지 않도록 **파일 시스템 연결**이 필요합니다.

1.  배포 설정의 **[파일 시스템]** 탭으로 이동합니다.
2.  **[볼륨 추가]**를 클릭합니다.
3.  **이름**: `bot-data` (원하는 이름)
4.  **용량**: `1GB` (무료 플랜 기준 충분함)
5.  **마운트 경로**: `/app/data` (**환경 변수 `DATA_DIR`과 일치해야 함**)
6.  설정을 저장하고 배포를 시작합니다.

---

## ⚠️ 주의사항

*   이 봇은 `attendance_data.db`와 `party_data.db`라는 SQLite 로컬 DB 파일을 생성하여 데이터를 저장합니다. 봇을 재설치하거나 이동할 때 이 파일들을 백업해야 데이터가 유지됩니다.
*   `prohibited_words.json` 파일이 `settings/` 디렉터리에 있어야 금지어 필터가 정상 작동합니다.
